<script>
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.documentElement.className.includes("dark")) {
            document.documentElement.classList.remove('dark');
            document.documentElement.dataset.scheme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.documentElement.classList.add('dark');
            document.documentElement.dataset.scheme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
        window.dispatchEvent(new CustomEvent('onColorSchemeChange', {
            detail: document.documentElement.dataset.scheme
        }));
    });

    const topLinkBtn = document.getElementById("top-link");

    window.onscroll = function () {
        scrollTop = document.documentElement["scrollTop"] || document.body["scrollTop"];
        if (scrollTop > 400) {
            topLinkBtn.style.visibility = "visible";
            topLinkBtn.style.opacity = "1";
        } else {
            topLinkBtn.style.visibility = "hidden";
            topLinkBtn.style.opacity = "0";
        }
    }
</script>

<script>
    var initMenu = () => {
      var navButtons = document.querySelectorAll(".nav-button");
      var navMenu = document.querySelector("#nav-menu");
      var navSocialLinks = document.querySelector("#nav-social-links");
  
      for (var button of navButtons) {
        button.addEventListener("click", () => {
          navMenu.classList.toggle("hidden");
  
          if (navSocialLinks) {
            navSocialLinks.classList.toggle("hidden");
          }
  
          for (var navButton of navButtons) {
            navButton.classList.toggle("hidden");
          }
        });
      }
    };
    document.addEventListener("load", initMenu());
</script>